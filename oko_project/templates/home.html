<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Bitrix Integration</title>
    <script src="https://cdn.bitrix24.ru/bx24.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            if (typeof BX24 !== 'undefined') {
                // SDK загружен, выполняем код
                BX24.init(function() {
                    BX24.getAuth(function(auth) {
                        if (auth && auth.access_token) {
                            fetch('https://reklamaoko.ru/static/button_handler.php', {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({
                                    auth: {
                                        access_token: auth.access_token
                                    }
                                })
                            })
                            .then(response => response.json())
                            .then(data => {
                                console.log(data);
                            })
                            .catch(error => console.error('Error:', error));
                        } else {
                            console.error('No access token received');
                        }
                    });
                });
            } else {
                console.error('Bitrix24 SDK не загружен. Убедитесь, что вы открываете это приложение внутри интерфейса Bitrix24.');
            }
        });
    </script>
</head>
<body>
    <h1>Bitrix24 Integration Example</h1>
</body>
</html>
